<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>8.nmap ,NSE中的数据文件 | w啥都学</title><meta name="description" content="NSE中的数据文件NSE中的数据文件文件在&#x2F;usr&#x2F;share&#x2F;nmap&#x2F;nselib&#x2F;data文件里面 nmap使用库的优先级优先级1：选项–datadir所指定的目录。优先级2：环境变量中指定的位置。优先级3：安装目录。优先级4：在编译时定义的目录。 暴力穷举时所使用的用户名和密码列表数据文件用户文件在&#x2F;usr&#x2F;share&#x2F;nmap&#x2F;nselib&#x2F;data&#x2F;usernames.lst密码文件在"><meta name="keywords" content="nmap"><meta name="author" content="w啥都学"><meta name="copyright" content="w啥都学"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://zaho-sai-sai.github.io/2020/08/29/8.nmap%20,NSE%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="article"><meta property="og:title" content="8.nmap ,NSE中的数据文件"><meta property="og:url" content="https://zaho-sai-sai.github.io/2020/08/29/8.nmap%20,NSE%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6/"><meta property="og:site_name" content="w啥都学"><meta property="og:description" content="NSE中的数据文件NSE中的数据文件文件在&#x2F;usr&#x2F;share&#x2F;nmap&#x2F;nselib&#x2F;data文件里面 nmap使用库的优先级优先级1：选项–datadir所指定的目录。优先级2：环境变量中指定的位置。优先级3：安装目录。优先级4：在编译时定义的目录。 暴力穷举时所使用的用户名和密码列表数据文件用户文件在&#x2F;usr&#x2F;share&#x2F;nmap&#x2F;nselib&#x2F;data&#x2F;usernames.lst密码文件在"><meta property="og:image" content="https://pic.3gbizhi.com/2019/0927/thumb_1680_0_20190927040015427.png"><meta property="article:published_time" content="2020-08-29T05:34:12.876Z"><meta property="article:modified_time" content="2020-08-29T05:39:58.896Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  hexoversion: '5.1.1',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true,
  postUpdate: '2020-08-29 13:39:58'
}</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img {
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 5.1.1"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" data-lazy-src="/img/avatar.gif" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">16</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">9</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">7</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#NSE%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6"><span class="toc-number">1.</span> <span class="toc-text">NSE中的数据文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#nmap%E4%BD%BF%E7%94%A8%E5%BA%93%E7%9A%84%E4%BC%98%E5%85%88%E7%BA%A7"><span class="toc-number">1.1.</span> <span class="toc-text">nmap使用库的优先级</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9A%B4%E5%8A%9B%E7%A9%B7%E4%B8%BE%E6%97%B6%E6%89%80%E4%BD%BF%E7%94%A8%E7%9A%84%E7%94%A8%E6%88%B7%E5%90%8D%E5%92%8C%E5%AF%86%E7%A0%81%E5%88%97%E8%A1%A8%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.</span> <span class="toc-text">暴力穷举时所使用的用户名和密码列表数据文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Web%E5%BA%94%E7%94%A8%E5%AE%A1%E8%AE%A1%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6"><span class="toc-number">1.3.</span> <span class="toc-text">Web应用审计数据文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DBMS-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-%E5%AE%A1%E6%A0%B8%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6"><span class="toc-number">1.4.</span> <span class="toc-text">DBMS(数据库管理系统)-审核数据文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%86%E7%A0%81%E5%AE%A1%E8%AE%A1%E8%84%9A%E6%9C%AC%E7%9A%84%E5%BC%80%E5%8F%91"><span class="toc-number">2.</span> <span class="toc-text">密码审计脚本的开发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8NSE%E5%BA%93%E8%BF%9B%E8%A1%8C%E5%B7%A5%E4%BD%9C"><span class="toc-number">2.1.</span> <span class="toc-text">使用NSE库进行工作</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%AE%A1%E8%AE%A1%E4%B8%8E%E6%B8%97%E9%80%8F%E8%84%9A%E6%9C%AC%E7%9A%84%E7%BC%96%E5%86%99"><span class="toc-number">3.</span> <span class="toc-text">漏洞审计与渗透脚本的编写</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Nmap%E4%B8%AD%E7%9A%84%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F%E5%8A%9F%E8%83%BD"><span class="toc-number">3.1.</span> <span class="toc-text">1.Nmap中的漏洞扫描功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-NSE%E4%B8%AD%E7%9A%84exploit%E8%84%9A%E6%9C%AC"><span class="toc-number">3.2.</span> <span class="toc-text">2. NSE中的exploit脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-RealVNC%E7%9A%84%E6%B8%97%E9%80%8F%E8%84%9A%E6%9C%AC"><span class="toc-number">3.3.</span> <span class="toc-text">2.RealVNC的渗透脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Windows%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E%E7%9A%84%E6%A3%80%E6%B5%8B"><span class="toc-number">3.4.</span> <span class="toc-text">3.Windows系统漏洞的检测</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9heartbleed%E6%BC%8F%E6%B4%9E%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F"><span class="toc-number">3.5.</span> <span class="toc-text">对heartbleed漏洞进行渗透</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NSE%E7%9A%84%E5%B9%B6%E5%8F%91%E6%89%A7%E8%A1%8C"><span class="toc-number">3.6.</span> <span class="toc-text">NSE的并发执行</span></a></li></ol></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(https://pic.3gbizhi.com/2019/0927/thumb_1680_0_20190927040015427.png)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">w啥都学</a></span><span class="pull-right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">8.nmap ,NSE中的数据文件</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-08-29T05:34:12.876Z" title="发表于 2020-08-29 13:34:12">2020-08-29</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2020-08-29T05:39:58.896Z" title="更新于 2020-08-29 13:39:58">2020-08-29</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/nmap/">nmap</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h2 id="NSE中的数据文件"><a href="#NSE中的数据文件" class="headerlink" title="NSE中的数据文件"></a>NSE中的数据文件</h2><p>NSE中的数据文件文件在<code>/usr/share/nmap/nselib/data</code>文件里面</p>
<h3 id="nmap使用库的优先级"><a href="#nmap使用库的优先级" class="headerlink" title="nmap使用库的优先级"></a>nmap使用库的优先级</h3><p><strong>优先级1</strong>：选项–datadir所指定的目录。<br><strong>优先级2</strong>：环境变量中指定的位置。<br><strong>优先级3</strong>：安装目录。<br><strong>优先级4</strong>：在编译时定义的目录。</p>
<h3 id="暴力穷举时所使用的用户名和密码列表数据文件"><a href="#暴力穷举时所使用的用户名和密码列表数据文件" class="headerlink" title="暴力穷举时所使用的用户名和密码列表数据文件"></a>暴力穷举时所使用的用户名和密码列表数据文件</h3><p>用户文件在<code>/usr/share/nmap/nselib/data/usernames.lst</code><br>密码文件在<code>/usr/share/nmap/nselib/data/passwords.lst</code></p>
<h3 id="Web应用审计数据文件"><a href="#Web应用审计数据文件" class="headerlink" title="Web应用审计数据文件"></a>Web应用审计数据文件</h3><ol>
<li>http-fingerprints.lua数据文件<br> 文件在<code>/usr/share/nmap/nselib/data/http-fingerprints.lua</code><br> 是使用<code>http-enum</code>(web枚举)用的参数脚本的时候调用的就是这个<br>  <code>http-fingerprints.lua</code>数据文件<br>  查看结果<br>  命令</li>
</ol>
<pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nmap --script http-enum  192.168.31.20 -p 80</span><br></pre></td></tr></table></figure>

![在这里插入图片描述](https://img-blog.csdnimg.cn/20200615153128197.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxODYwODc2,size_16,color_FFFFFF,t_70)
 另外，如果希望在http-enum脚本执行的时候使用其他的数据文件，也可以在执行的时候使用参数--script-args http-enum.fingerprintfile来指定。例如要使用./myfingerprints.txt就可以执行如下命令。    


<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap --script http-enum --script-args http-enum.ﬁngerprintﬁle&#x3D;.&#x2F;myﬁngerprints. txt -p80 目标地址</span><br></pre></td></tr></table></figure></code></pre>
<ol start="2">
<li>http-sql-errors.lst数据文件<br> 文件在<code>/usr/share/nmap/nselib/data/http-sql-errors.lst</code><br> 使用脚本参数<code>http-sql-injection</code>会调用<code>http-sql-errors.lst</code>数据文件<br> 用来完成对应用是否能够抵御SQL注入进行检测。这个文件中一共包含了339个字符串<br> 咧<br> 命令</li>
</ol>
<pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nmap --script http-sql-injection 192.168.31.20  -p 80 </span><br></pre></td></tr></table></figure>
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200615153213522.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxODYwODc2,size_16,color_FFFFFF,t_70)</code></pre>
<p>同样也可以使用参数http-sql-injection.errorstrings来改变这个脚本执行时所使用的数据文件。    </p>
<pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap --script http-sql-injection --script-args http-sql-injection.errorstrings&#x3D;&#x2F;home&#x2F;errors.txt 目标地址</span><br></pre></td></tr></table></figure></code></pre>
<ol start="3">
<li>http-devframework-fingerprints.lua数据文件<br> 文件在<code>/usr/share/nmap/nselib/data/http-devframework-fingerprints.lua</code><br> 这个数据文件由Lua table所构成，被脚本<code>http-devframework</code>所调用，目的是检测目标Web应用的开发语言，例如ASP、PHP等。<br> 这个table中的每一项都包含了如下字段。<br> <strong>Name：开发环境的描述性名称。<br> RapidDetect：在检测过程开始执行的回调函数。<br> consumingDetect：一个在爬虫页面执行的回调函数</strong><br> 咧<br> 命令</li>
</ol>
<pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nmap --script http-devframework  192.168.31.20  -p 80</span><br></pre></td></tr></table></figure>
结果没有扫描出来
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200615154735338.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxODYwODc2,size_16,color_FFFFFF,t_70)</code></pre>
<ol start="4">
<li>http-folders.txt数据文件<br> 文件在<code>/usr/share/nmap/nselib/data/http-folders.txt</code><br> 这个数据文件中包含了956个HTTP中常见的目录名，被脚本http-iis-webdav-vuln所调用，用来检测IIS 5.1/6.0类型服务器上的漏洞<br> 咧<br> 命令</li>
</ol>
<pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nmap --script http-iis-webdav-vuln  192.168.31.20  -p 80</span><br></pre></td></tr></table></figure>
下面的结果目标是不存在漏洞的
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200615160326189.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxODYwODc2,size_16,color_FFFFFF,t_70)</code></pre>
<p>如果不想使用这个数据文件，也可以使用参数–script-args folderdb来指定其他的数据文件，<br>例如使用/pentest/fuzzers/folders.txt作为这个目录</p>
<pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nmap --script http-iis-webdav-vuln   --script-args folderdb&#x3D;&#x2F;pentest&#x2F;fuzzers&#x2F;folders.txt 目标地址</span><br></pre></td></tr></table></figure></code></pre>
<ol start="5">
<li>vhosts-default.lst数据文件<br> 文件在<code>/usr/share/nmap/nselib/data/vhosts-default.lst</code><br> 脚本<code>http-vhosts</code>就是用这个数据文件来判断目标服务器到底是一个虚拟机还是一个真正的Web服务器<br> 咧<br> 命令</li>
</ol>
<pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nmap --script http-vhosts  192.168.31.20  -p 80</span><br></pre></td></tr></table></figure>
结果是
![在这里插入图片描述](https://img-blog.csdnimg.cn/2020061516231119.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxODYwODc2,size_16,color_FFFFFF,t_70)</code></pre>
<h3 id="DBMS-数据库管理系统-审核数据文件"><a href="#DBMS-数据库管理系统-审核数据文件" class="headerlink" title="DBMS(数据库管理系统)-审核数据文件"></a>DBMS(数据库管理系统)-审核数据文件</h3><ol>
<li>mysql-cis.audit数据文件<br> 文件在<code>/usr/share/nmap/nselib/data/mysql-cis.audit</code><br> 这个文件位于Nmap的安装目录中，主要根据CIS MySQL v1.0.2 benchmark来检测MySQL数据库的配置安全性。NSE中有一个<code>mysql-audit</code>脚本就是使用了这个文件，</li>
<li>oracle-default-accounts.lst数据文件<br> 文件在<code>/usr/share/nmap/nselib/data/oracle-default-accounts.lst</code><br> 这个文件中包含了687个Oracle数据库中用来验证的用户名。这个文件被<code>oracle-brute</code>和<code>oracle-brute-stealth</code>两个脚本所调用</li>
<li>oracle-sids数据文件<br>文件在<code>/usr/share/nmap/nselib/data/oracle-sids</code><br>文件oracle-sids包含了700个常见的Oracle数据库实例名，这个文件被脚本<code>oracle-sid-brute</code>调用</li>
</ol>
<h2 id="密码审计脚本的开发"><a href="#密码审计脚本的开发" class="headerlink" title="密码审计脚本的开发"></a>密码审计脚本的开发</h2><h3 id="使用NSE库进行工作"><a href="#使用NSE库进行工作" class="headerlink" title="使用NSE库进行工作"></a>使用NSE库进行工作</h3><p>看不懂</p>
<h2 id="漏洞审计与渗透脚本的编写"><a href="#漏洞审计与渗透脚本的编写" class="headerlink" title="漏洞审计与渗透脚本的编写"></a>漏洞审计与渗透脚本的编写</h2><h3 id="1-Nmap中的漏洞扫描功能"><a href="#1-Nmap中的漏洞扫描功能" class="headerlink" title="1.Nmap中的漏洞扫描功能"></a>1.Nmap中的漏洞扫描功能</h3><p>平时可能会用到一些专业的漏洞扫描器，例如Nessus或者OpenVas等，nmap也有很多的漏洞扫描功能<br>使用NSE来完成漏洞扫描的优势包括以下几点</p>
<ol>
<li>可以使用Nmap API来完成对扫描过程中收集信息的处理</li>
<li>NSE脚本可以在执行过程中和其他的脚本共享获得的信息</li>
<li>中提供了大量网络协议库的组件。</li>
<li>NSE中提供了漏洞库文件，利用漏洞库文件可以创建一份优秀的漏洞报告。</li>
<li>NSE中提供了强大的并发机制和错误处理机制</li>
</ol>
<p>咧对目标一个整个分类进行扫描<br><img src= "/img/loading.gif" data-lazy-src="https://img-blog.csdnimg.cn/20200616164725430.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxODYwODc2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nmap -sV --version-all -p- --script [类型的名字] 192.168.31.20 </span><br></pre></td></tr></table></figure>
<p> <strong><code>--script</code>后面类型名字是对这个类型的所有脚本进行扫描</strong><br> <strong><code>-p-</code>是对有效的端口进行扫描</strong><br><strong><code>--version-all</code>相当于–version-intensity 9 扫描强度</strong><br>也可以所有扫描的内容给列出来</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nmap -sV --script vuln --script-args vulns.showall 192.168.31.20</span><br></pre></td></tr></table></figure>

<p>结果<br><img src= "/img/loading.gif" data-lazy-src="https://img-blog.csdnimg.cn/202006161720392.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxODYwODc2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h3 id="2-NSE中的exploit脚本"><a href="#2-NSE中的exploit脚本" class="headerlink" title="2. NSE中的exploit脚本"></a>2. NSE中的exploit脚本</h3><p>全部exploit类型的脚本<a target="_blank" rel="noopener" href="https://nmap.org/nsedoc/categories/exploit.html">https://nmap.org/nsedoc/categories/exploit.html</a><br>的exploit分类包含32个脚本，这些脚本都是用来对某些应用和服务进行渗透的</p>
<ol>
<li><code>http-csrf</code>：专门用来检测目标网站是否存在跨站点请求伪造（csrf）漏洞。<br> 命令</li>
</ol>
<pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nmap --script http-csrf 192.168.31.20   -p 80</span><br></pre></td></tr></table></figure></code></pre>
<p><img src= "/img/loading.gif" data-lazy-src="https://img-blog.csdnimg.cn/20200616165534814.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxODYwODc2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>2. <code>http-stored-xss</code>：专门用来检测目标网站是否存在存储型跨站（xss）漏洞。</p>
<ol start="3">
<li><code>http-adobe-coldfusion-apsa1301</code>：专门用来检测目标网站是否存在adobe-coldfusion-apsa1301漏洞</li>
<li><code>smb-check-vulns</code>：专门用来检测目标为Windows操作系统上的一个ms08_067漏洞，这个漏洞曾经广泛存在于Windows XP和Windows 2003中</li>
<li>获得目标的一些有用信息之后，例如目标服务器的类型为IIS，可以在整个脚本中查找相关的漏洞。针对这个IIS，可以查找到一个iis-short-name-brute（ IIS短文件名暴力枚举）漏洞渗透脚本，这个脚本的名字为http-iis-short-name-brute.NSE。这是一个微软IIS漏洞，攻击者可以利用一个包含“~”的get请求，从而导致目标服务器上的文件和文件夹泄漏<br>受到影响的服务器软件版本有如下这些。<br>IIS 1.0，Windows NT 3.51IIS 2.0，Windows NT 4.0IIS 3.0，Windows NT 4.0 Service Pack 2IIS 4.0，Windows NT 4.0 Option PackIIS 5.0，Windows 2000IIS 5.1，Windows XP Professional和Windows XP Media Center EditionIIS 6.0，Windows Server 2003和Windows XP Professional x64 Edition IIS 7.0，Windows Server 2008和Windows VistaaIIS 7.5，Windows 7（远程开启了错误或者没有web.config配置文件的情况下）IIS 7.5，Windows 2008（经典托管管道模式）执行这个脚本的命令格式如下。<br> 命令 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -p80 --script http-iis-short-name-brute  [目标]</span><br></pre></td></tr></table></figure>
<h3 id="2-RealVNC的渗透脚本"><a href="#2-RealVNC的渗透脚本" class="headerlink" title="2.RealVNC的渗透脚本"></a>2.RealVNC的渗透脚本</h3>是一个远程操控软件<br>但是在这款软件的很多过时版本中都存在着一些漏洞，尤其是realvnc-auth-bypass（RealVNC认证绕过）漏洞，可能导致攻击者直接绕过认证机制</li>
</ol>
<p>咧<br>RealVNC漏洞扫描脚本<br>代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">local shortport &#x3D; require &quot;shortport&quot;</span><br><span class="line">local nmap &#x3D; require &quot;nmap&quot;</span><br><span class="line">local vulns &#x3D; require &quot;vulns&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">description &#x3D; [[]]</span><br><span class="line"></span><br><span class="line">author &#x3D; &quot;root&quot;</span><br><span class="line"></span><br><span class="line">license &#x3D; &quot;Same as Nmap--See http:&#x2F;&#x2F;nmap.org&#x2F;book&#x2F;man-legal.html&quot;</span><br><span class="line">categories &#x3D; &#123;&quot;default&quot;,&quot;safe&quot;&#125;</span><br><span class="line"></span><br><span class="line">portrule &#x3D; shortport.port_or_service(5900, &quot;vnc&quot;)</span><br><span class="line"></span><br><span class="line">action &#x3D; function(host, port)</span><br><span class="line">	</span><br><span class="line">	local socket &#x3D; nmap.new_socket()      </span><br><span class="line">	local result      </span><br><span class="line">	local status &#x3D; true      </span><br><span class="line">	socket:connect(host, port)      </span><br><span class="line">	status, result &#x3D; socket:receive_lines(1)      </span><br><span class="line">	</span><br><span class="line">	if (not status) </span><br><span class="line">	then      </span><br><span class="line">		socket:close()      </span><br><span class="line">	return      </span><br><span class="line">	end</span><br><span class="line">	      </span><br><span class="line">	socket:send(&quot;RFB 003.008\n&quot;)      </span><br><span class="line">	status, result &#x3D; socket:receive_bytes(2)     </span><br><span class="line">	</span><br><span class="line">	if (not status or result ~&#x3D; &quot;\001\002&quot;) </span><br><span class="line">	then      </span><br><span class="line">		socket:close()    </span><br><span class="line">	end     </span><br><span class="line">	</span><br><span class="line">	socket:send(&quot;\001&quot;)      </span><br><span class="line">	status, result &#x3D; socket:receive_bytes(4)      </span><br><span class="line">	</span><br><span class="line">	if (not status or result ~&#x3D; &quot;\000\000\000\000&quot;) </span><br><span class="line">	then      </span><br><span class="line">		socket:close()      </span><br><span class="line">		return      </span><br><span class="line">	end      </span><br><span class="line">	</span><br><span class="line">	socket:close()      </span><br><span class="line">	</span><br><span class="line">	return &quot;Vulnerable&quot;      </span><br><span class="line"></span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<p>代码说明</p>
<ol>
<li><p>导入需要的库</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">local shortport &#x3D; require &quot;shortport&quot;</span><br><span class="line">local nmap &#x3D; require &quot;nmap&quot;</span><br><span class="line">local vulns &#x3D; require &quot;vulns&quot;</span><br></pre></td></tr></table></figure></li>
<li><p>这个脚本的执行规则是发现端口为5900、服务为VNC的目标后执行</p>
</li>
</ol>
<pre><code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">portrule &#x3D; shortport.port_or_service(5900, &quot;vnc&quot;)</span><br></pre></td></tr></table></figure></code></pre>
<ol start="3">
<li>首先创建一个socket函数，与目标服务进行通信，然后向目标发送探针数据包，根据返回的回应包来检测目标上运行的RealVNC是否存在漏洞<br> <code>action</code>里面的</li>
</ol>
<h3 id="3-Windows系统漏洞的检测"><a href="#3-Windows系统漏洞的检测" class="headerlink" title="3.Windows系统漏洞的检测"></a>3.Windows系统漏洞的检测</h3><p>使用系统漏洞检查可能会对目标系统造成伤害，nmap自己开启了谨慎的操作，如果想去掉，可以添加<code>--script-args unsafe</code><br>在扫描的时候，这种脚本可能会引起目标系统的崩溃<br>咧<br>命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nmap -p- -sV --script vuln --script-args unsafe 192.168.31.20</span><br></pre></td></tr></table></figure>
<p><img src= "/img/loading.gif" data-lazy-src="https://img-blog.csdnimg.cn/2020061619445357.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxODYwODc2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h3 id="对heartbleed漏洞进行渗透"><a href="#对heartbleed漏洞进行渗透" class="headerlink" title="对heartbleed漏洞进行渗透"></a>对heartbleed漏洞进行渗透</h3><p>看不懂</p>
<h3 id="NSE的并发执行"><a href="#NSE的并发执行" class="headerlink" title="NSE的并发执行"></a>NSE的并发执行</h3></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">w啥都学</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://zaho-sai-sai.github.io/2020/08/29/8.nmap%20,NSE%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6/">https://zaho-sai-sai.github.io/2020/08/29/8.nmap%20,NSE%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://Zaho-Sai-Sai.github.io" target="_blank">w啥都学</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/nmap/">nmap</a></div><div class="post_share"><div class="social-share" data-image="https://pic.3gbizhi.com/2019/0927/thumb_1680_0_20190927040015427.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://img-blog.csdnimg.cn/20200828141226374.png" target="_blank"><img class="post-qr-code-img" data-lazy-src="https://img-blog.csdnimg.cn/20200828141226374.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://img-blog.csdnimg.cn/20200828141103233.jpg" target="_blank"><img class="post-qr-code-img" data-lazy-src="https://img-blog.csdnimg.cn/20200828141103233.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/08/29/2.%20nmap%E4%BC%AA%E8%A3%85%E6%8A%80%E6%9C%AF%E5%92%8C%E6%A3%80%E6%9F%A5%EF%BC%8CNSE%E7%9A%84%E5%9F%BA%E7%A1%80%EF%BC%8C%E5%8E%9F%E7%90%86%E5%92%8C%E8%84%9A%E6%9C%AC/"><img class="prev-cover" data-lazy-src="https://pic.3gbizhi.com/2020/0824/20200824113626427.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info"></div></div></a></div><div class="next-post pull-right"><a href="/2020/08/29/7,%20nmap,NSE%E5%BA%93%E6%96%87%E4%BB%B6/"><img class="next-cover" data-lazy-src="https://pic.3gbizhi.com/2019/0927/thumb_1680_0_20190927040015427.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">7, nmap,NSE库文件</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/08/29/1 nmap扫描 扫描格式，活主机，端口扫描/" title="1 nmap扫描 扫描格式，活主机，端口扫描"><img class="relatedPosts_cover" data-lazy-src="https://pic.3gbizhi.com/2014/0531/thumb_1680_0_20140531055149349.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-29</div><div class="relatedPosts_title">1 nmap扫描 扫描格式，活主机，端口扫描</div></div></a></div><div class="relatedPosts_item"><a href="/2020/08/29/3，nmap，NSE脚本格式和编写/" title="3，nmap，NSE脚本格式和编写"><img class="relatedPosts_cover" data-lazy-src="https://pic.3gbizhi.com/2019/0923/thumb_1680_0_20190923050724433.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-29</div><div class="relatedPosts_title">3，nmap，NSE脚本格式和编写</div></div></a></div><div class="relatedPosts_item"><a href="/2020/08/29/4，nmap，Lua语言/" title="4，nmap，Lua语言"><img class="relatedPosts_cover" data-lazy-src="https://pic.3gbizhi.com/2019/1124/thumb_1680_0_20191124050326445.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-29</div><div class="relatedPosts_title">4，nmap，Lua语言</div></div></a></div><div class="relatedPosts_item"><a href="/2020/08/29/5，nmap，2.Lua语言，nmap NSE中的API，host table(表)/" title="5，nmap，2.Lua语言，nmap NSE中的API，host table(表)"><img class="relatedPosts_cover" data-lazy-src="https://pic.3gbizhi.com/2019/0927/thumb_1680_0_20190927040015427.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-29</div><div class="relatedPosts_title">5，nmap，2.Lua语言，nmap NSE中的API，host table(表)</div></div></a></div><div class="relatedPosts_item"><a href="/2020/08/29/6 ,nmap NSE中的API port table(表)，NSE库文件编写/" title="6 ,nmap NSE中的API port table(表)，NSE库文件编写"><img class="relatedPosts_cover" data-lazy-src="https://pic.3gbizhi.com/2019/0927/thumb_1680_0_20190927040015427.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-29</div><div class="relatedPosts_title">6 ,nmap NSE中的API port table(表)，NSE库文件编写</div></div></a></div><div class="relatedPosts_item"><a href="/2020/08/29/7, nmap,NSE库文件/" title="7, nmap,NSE库文件"><img class="relatedPosts_cover" data-lazy-src="https://pic.3gbizhi.com/2019/0927/thumb_1680_0_20190927040015427.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-29</div><div class="relatedPosts_title">7, nmap,NSE库文件</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></article></main><footer id="footer" style="background-image: url(https://pic.3gbizhi.com/2019/0927/thumb_1680_0_20190927040015427.png)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2020 By w啥都学</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font_plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font_minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    window.valine = new Valine({
      el: '#vcomment',
      appId: '',
      appKey: '',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
    });
    if ('nick,mail') { valine.config.requiredFields= 'nick,mail'.split(',') }
  }

  if (typeof Valine === 'function') initValine() 
  else $.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) loadComment(document.querySelector('#vcomment'),loadValine)
  else setTimeout(() => loadValine(), 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><canvas class="fireworks"></canvas><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="/js/third-party/fireworks.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  'meta[name=description]',
  '#config_change',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

const pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
})

document.addEventListener('pjax:complete', function () {
  refreshFn()

  $('script[data-pjax]').each(function () {
    $(this).parent().append($(this).remove())
  })

  GLOBAL_CONFIG.islazyload && lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  if (typeof gtag === 'function') {
    gtag('config', '', {'page_path': window.location.pathname});
  }

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

})

document.addEventListener('pjax:send', function () {
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  $(window).off('scroll')

  //reset readmode
  $('body').hasClass('read-mode') && $('body').removeClass('read-mode')

  //reset font-size
  $('body').css('font-size') !== originFontSize && $('body').css('font-size', parseFloat(originFontSize))
})</script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>